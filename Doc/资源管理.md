# 资源管理

不要造轮子

真实商业引擎需要的是：
* VFS，虚拟文件系统，一个操作系统级别的文件系统
* 资源管理编辑器，支持多人协作编辑，VCS

而我们直接读文件就够用了，把资源管线做灵活清晰是首要的

所以不要造轮子

那我们现在能做什么：
1. 用lua作为资源配置文件格式
2. 灵活性，可扩展，可控，可编程
3. 模块机制，自带缓存和热更机制，在这个机制上套一层去跑解析器

# 脚本交互

SpawnPrefab，在C++做了解析去构造MeshRenderer
何不直接用lua写这个逻辑呢，这样就更加接近threejs的接口了

# 资源缓存

Resource.read接口每次会读取文件，其实是一个fileio接口

这个接口主要是读取二进制流，路径上做一个fallback

我们在脚本层构造资源，做资源缓存，lua没有引用了这个资源就会走GC析构释放

---

1. 从磁盘加载数据到内存，fileio接口
2. 解析原始数据到struct，一般是树，复杂的是DAG
3. 将struct加载到显存，一般是GL对象，或者一块裸显存

所以我们需要parser和loader，两个要分开，因为loader会调用GL

* model parser，目前是assimp封装，加载blender导出的obj，得到mesh，关联材质信息
* texture parser，stbimage封装
* mesh loader
* texture loader
* shader loader

---

2021年11月14日

资源软链到引擎目录下，和ThirdParty的方式一样，不要在引擎运行时写死路径

资源描述文件（元文件）从散文件整合到一个大的仓库文件，用lua表嵌套替代文件目录嵌套